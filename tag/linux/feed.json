{
    "version": "https://jsonfeed.org/version/1",
    "title": "心夢博客 • All posts by \"linux\" tag",
    "description": "",
    "home_page_url": "https://xmengnet.github.io",
    "items": [
        {
            "id": "https://xmengnet.github.io/2021/03/22/Arch%E6%90%AD%E5%BB%BANginx-MariaDB-PHP%E5%8F%8A%E5%85%B6%E9%85%8D%E7%BD%AE/",
            "url": "https://xmengnet.github.io/2021/03/22/Arch%E6%90%AD%E5%BB%BANginx-MariaDB-PHP%E5%8F%8A%E5%85%B6%E9%85%8D%E7%BD%AE/",
            "title": "Arch搭建Nginx+MariaDB+PHP及其配置",
            "date_published": "2021-03-22T11:31:51.000Z",
            "content_html": "<h2 id=\"写在前面\"><a href=\"#写在前面\" class=\"headerlink\" title=\"写在前面\"></a>写在前面</h2><p> 最近在阿里云上新买了一个服务器，想换个风格，不想使用<code>Centos</code>或者<code>Debian</code>，想试试<code>Arch</code>做服务器，由于阿里云没有<code>Arch</code>系统，所以先在<code>Github</code>上使用<a href=\"https://github.com/xmengnet/vps2arch\">vps2arch</a>转换成Arch系统。</p>\n<p>使用方法也简单，下载<code>vps2arch</code>那个文件，然后使用</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs jboss-cli\">chmod +x vps2arch2<br><span class=\"hljs-string\">./vps2arch2</span><br></code></pre></td></tr></table></figure>\n\n<p>执行后就可以替换成Arch系统，<strong>注意：本人使用的是阿里云的<code>Debian </code>9.9系统，8.x的安装<code>Arch</code>失败。</strong></p>\n<blockquote>\n<p>如果在<code>vps</code>上下载<code>github</code>文件太慢，可以先下载在本地，然后使用<code>rsync</code>服务上传到服务器，下面是<code>rsync</code>的用法：</p>\n<p><code>rsync -P -r 你要上传文件的位置如：/home/liyp/Desktop/vps2arch root@ip地址:文件路径如/root</code></p>\n</blockquote>\n<p>安装完成记得使用快照备份一下数据，防止系统崩溃导致一切都要重来。</p>\n<p>系统搞好后就开始步入正题了：</p>\n<h2 id=\"1、安装相关软件\"><a href=\"#1、安装相关软件\" class=\"headerlink\" title=\"1、安装相关软件\"></a>1、安装相关软件</h2><p>以下操作都在root用户下执行</p>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs ebnf\"><span class=\"hljs-attribute\">pacman -S nginx php php-fpm mariadb</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"2、配置\"><a href=\"#2、配置\" class=\"headerlink\" title=\"2、配置\"></a>2、配置</h2><h4 id=\"配置-MariaDB-数据库\"><a href=\"#配置-MariaDB-数据库\" class=\"headerlink\" title=\"配置 MariaDB 数据库\"></a>配置 <code>MariaDB</code> 数据库</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"配置MySQL-root密码，根据自己需求选择。\"><a href=\"#配置MySQL-root密码，根据自己需求选择。\" class=\"headerlink\" title=\"配置MySQL root密码，根据自己需求选择。\"></a>配置MySQL root密码，根据自己需求选择。</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mysql_secure_installation<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"配置-MySQL-utf8mb4-字符集\"><a href=\"#配置-MySQL-utf8mb4-字符集\" class=\"headerlink\" title=\"配置 MySQL utf8mb4 字符集\"></a>配置 MySQL utf8mb4 字符集</h4><figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">vim <span class=\"hljs-regexp\">/etc/my</span>.cnf<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"在末尾追加\"><a href=\"#在末尾追加\" class=\"headerlink\" title=\"在末尾追加\"></a>在末尾追加</h4><figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs ini\"><span class=\"hljs-section\">[client]</span><br><span class=\"hljs-attr\">default-character-set</span>=utf8mb4<br><span class=\"hljs-section\">[mysql]</span><br><span class=\"hljs-attr\">default-character-set</span>=utf8mb4<br><span class=\"hljs-section\">[mysqld]</span><br><span class=\"hljs-attr\">character-set-client-handshake</span> = <span class=\"hljs-literal\">FALSE</span><br><span class=\"hljs-attr\">character-set-server</span>=utf8mb4<br><span class=\"hljs-attr\">collation-server</span> = utf8mb4_unicode_ci<br><span class=\"hljs-attr\">init_connect</span>=<span class=\"hljs-string\">&#x27;SET NAMES utf8mb4&#x27;</span><br><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"配置-Nginx-支持-PHP\"><a href=\"#配置-Nginx-支持-PHP\" class=\"headerlink\" title=\"配置 Nginx 支持 PHP\"></a>配置 <code>Nginx</code> 支持 <code>PHP</code></h4><figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">location / &#123;<br>    root   <span class=\"hljs-regexp\">/usr/</span>share<span class=\"hljs-regexp\">/nginx/</span>html;<br>    index  index.php index.html index.htm;<br>&#125;<br><br>location ~ \\.php$ &#123;<br>    fastcgi_pass   unix:<span class=\"hljs-regexp\">/run/</span>php-fpm/php-fpm.sock;<br>    fastcgi_index  index.php;<br>    fastcgi_param  SCRIPT_FILENAME  <span class=\"hljs-regexp\">/usr/</span>share<span class=\"hljs-regexp\">/nginx/</span>html<span class=\"hljs-variable\">$fastcgi_script_name</span>;<br>    include        fastcgi_params;<br>&#125;<br><br></code></pre></td></tr></table></figure>\n\n<h1 id=\"3、服务测试\"><a href=\"#3、服务测试\" class=\"headerlink\" title=\"3、服务测试\"></a>3、服务测试</h1><figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs 1c\">php-fpm -t  <span class=\"hljs-meta\">#查看 PHP 配置是否正确</span><br>nginx -t <span class=\"hljs-meta\">#查看nginx服务配置是否正确</span><br></code></pre></td></tr></table></figure>\n\n<h1 id=\"4、启动\"><a href=\"#4、启动\" class=\"headerlink\" title=\"4、启动\"></a>4、启动</h1><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs maxima\">systemctl <span class=\"hljs-built_in\">restart</span> php-fpm<br><br>systemctl <span class=\"hljs-built_in\">restart</span> nginx<br><br>systemctl <span class=\"hljs-built_in\">restart</span> mysqld<br><br></code></pre></td></tr></table></figure>\n\n<h1 id=\"5、配置开机启动\"><a href=\"#5、配置开机启动\" class=\"headerlink\" title=\"5、配置开机启动\"></a>5、配置开机启动</h1><figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs routeros\">systemctl <span class=\"hljs-builtin-name\">enable</span> nginx<br>systemctl <span class=\"hljs-builtin-name\">enable</span> mysqld<br>systemctl <span class=\"hljs-builtin-name\">enable</span> php-fpm<br></code></pre></td></tr></table></figure>\n\n<h1 id=\"6、测试\"><a href=\"#6、测试\" class=\"headerlink\" title=\"6、测试\"></a>6、测试</h1><h4 id=\"Nginx-PHP-环境测试\"><a href=\"#Nginx-PHP-环境测试\" class=\"headerlink\" title=\"Nginx+PHP 环境测试\"></a>Nginx+PHP 环境测试</h4><figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">vim <span class=\"hljs-regexp\">/usr/</span>share<span class=\"hljs-regexp\">/nginx/</span>html/index.php<br></code></pre></td></tr></table></figure>\n\n<p>输入：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br>    phpinfo();<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>网页打开：<code>http://服务器ip地址 </code></p>\n<p>如果出现 <code>PHPinfo</code> 页面则安装成功。</p>\n<p><strong>注意：建议测试ip的时候在浏览器的隐私界面测试，防止缓存干扰</strong></p>\n<h1 id=\"7、卸载\"><a href=\"#7、卸载\" class=\"headerlink\" title=\"7、卸载\"></a>7、卸载</h1><figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs ebnf\"><span class=\"hljs-attribute\">pacman -Rs nginx php-fpm mariadb</span><br></code></pre></td></tr></table></figure>\n\n<h1 id=\"8、数据库相关操作\"><a href=\"#8、数据库相关操作\" class=\"headerlink\" title=\"8、数据库相关操作\"></a>8、数据库相关操作</h1><p>如果你不想使用root操作数据库，你可以创建一个用户和数据库，把数据库的所有操作权限授予新创建的用户。</p>\n<h4 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h4><p>命令:**CREATE USER ‘username’@’host’ IDENTIFIED BY ‘password’; **</p>\n<p>说明:<br><code>username</code>- 你将创建的用户名,<br> <code>host </code>- 指定该用户在哪个主机上可以登陆,如果是本地用户可用<code>localhost</code>, 如果想让该用户可以从任意远程主机登陆,可以使用通配符%.<br> <code>password</code> - 该用户的登陆密码,密码可以为空,如果为空则该用户可以不需要密码登陆服务器.</p>\n<p>例子：</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">USER</span> <span class=\"hljs-string\">&#x27;blog&#x27;</span>@<span class=\"hljs-string\">&#x27;%&#x27;</span> IDENTIFIED <span class=\"hljs-keyword\">BY</span> <span class=\"hljs-string\">&#x27;123456&#x27;</span>;<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"授权\"><a href=\"#授权\" class=\"headerlink\" title=\"授权\"></a>授权</h4><p>命令:</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"><span class=\"hljs-keyword\">GRANT</span> <span class=\"hljs-keyword\">privileges</span> <span class=\"hljs-keyword\">ON</span> databasename.tablename <span class=\"hljs-keyword\">TO</span> <span class=\"hljs-string\">&#x27;username&#x27;</span>@<span class=\"hljs-string\">&#x27;host&#x27;</span> <br></code></pre></td></tr></table></figure>\n\n\n<p> 说明:<code> privileges</code> - 用户的操作权限,如SELECT , INSERT , UPDATE 等.如果要授予所的权限则使用ALL.;<br> <code>databasename</code> - 数据库名,<br> <code>tablename</code>-表名,<br> 如果要授予该用户对所有数据库和表的相应操作权限则可用 * 表示, 如 <em>.</em></p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"><span class=\"hljs-keyword\">GRANT</span> <span class=\"hljs-keyword\">ALL</span> <span class=\"hljs-keyword\">ON</span> blog.* <span class=\"hljs-keyword\">TO</span> <span class=\"hljs-string\">&#x27;blog&#x27;</span>@<span class=\"hljs-string\">&#x27;%&#x27;</span>;<br>flush <span class=\"hljs-keyword\">privileges</span>; #刷新权限<br></code></pre></td></tr></table></figure>\n\n<p>建议把网站相关的都放到<code>/srv</code>文件夹下，我网站的<code>/srv</code>目录如下图：</p>\n<p><img  src=\"https://i.bmp.ovh/imgs/2021/02/5cd1c7b6be031432.png\"  ><span class=\"image-caption\">/srv目录</span></p>\n<p>参考网站：<a href=\"https://www.ycmbcd.com/blog/html/15778576279282.html\">https://www.ycmbcd.com/blog/html/15778576279282.html</a></p>\n<pre><code>                https://www.jianshu.com/p/4466e0cd0bd1\n</code></pre>\n",
            "tags": [
                "Linux"
            ]
        }
    ]
}